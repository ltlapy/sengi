<form class="status-editor" (ngSubmit)="onSubmit()">
    <input [(ngModel)]="title" type="text" class="form-control form-control-sm status-editor__title" name="title" 
        autocomplete="off" placeholder="주제, 경고 문구 (옵션)" title="주제, 경고 문구 (옵션)" dir="auto" />

        <a class="status-editor__emoji" title="이모지 추가하기"
            #emojiButton href (click)="openEmojiPicker($event)">
            <img class="status-editor__emoji--image" src="/assets/emoji/72x72/1f636.png">
        </a>

    <textarea #reply [(ngModel)]="status" name="status" class="form-control form-control-sm status-editor__content" (paste)="onPaste($event)"
        rows="5" required title="본문" placeholder="무엇을 생각하고 계신가요?" (keydown.control.enter)="onCtrlEnter()"
        (keydown)="handleKeyDown($event)" (blur)="statusTextEditorLostFocus()" dir="auto">
    </textarea>

    <div class="status-editor__mention-error" *ngIf="mentionTooFarAwayError">오류: 멘션이 처음과 너무 멀리 떨어져 있어
        멀티 포스팅 기능을 사용할 수 없습니다.</div>

    <app-autosuggest class="status-editor__autosuggest" *ngIf="autosuggestData" [pattern]="autosuggestData"
        [autoSuggestUserActionsStream]="autoSuggestUserActionsStream"
        (suggestionSelectedEvent)="suggestionSelected($event)" (hasSuggestionsEvent)="suggestionsChanged($event)">
    </app-autosuggest>

    <app-poll-editor *ngIf="instanceSupportsPoll && pollIsActive"></app-poll-editor>

    <app-status-scheduler class="scheduler" *ngIf="instanceSupportsScheduling && scheduleIsActive"></app-status-scheduler>

    <div class="status-editor__footer" #footer>
        <button type="submit" title="답글" class="status-editor__footer--send-button" *ngIf="statusReplyingToWrapper">
            <span *ngIf="!isSending && !scheduleIsActive">답글!</span>
            <span *ngIf="!isSending && scheduleIsActive">예약!</span>
            <app-waiting-animation class="waiting-icon" *ngIf="isSending"></app-waiting-animation>
        </button>
        <button type="submit" title="게시" class="status-editor__footer--send-button" *ngIf="!statusReplyingToWrapper">
            <span *ngIf="!isSending && !scheduleIsActive">게시!</span>
            <span *ngIf="!isSending && scheduleIsActive">예약!</span>
            <app-waiting-animation class="waiting-icon" *ngIf="isSending"></app-waiting-animation>
        </button>
        <div class="status-editor__footer__counter">
            <div class="status-editor__footer__counter--posts" title="게시물 수">
                {{postCounts - 1}}/{{postCounts}}</div>
            <div class="status-editor__footer__counter--count" title="남은 글자수">{{charCountLeft}}</div>
        </div>

        <a href class="status-editor__footer--link" title="미디어 추가" (click)="addMedia()">
            <fa-icon [icon]="faPaperclip"></fa-icon>
        </a>
        <input #fileInput type="file" id="file" style="display: none;" (change)="handleFileInput($event.target.files)">

        <a href class="status-editor__footer--link" title="{{ selectedPrivacy }}" (click)="onContextMenu($event)">
            <fa-icon [icon]="faGlobeAmericas" *ngIf="selectedPrivacy === 'Public'"></fa-icon>
            <fa-icon [icon]="faLockOpen" *ngIf="selectedPrivacy === 'Unlisted'"></fa-icon>
            <fa-icon [icon]="faLock" *ngIf="selectedPrivacy === 'Follows-only'"></fa-icon>
            <fa-icon [icon]="faEnvelope" *ngIf="selectedPrivacy === 'DM'"></fa-icon>
        </a>

        <a href *ngIf="instanceSupportsPoll"
            class="status-editor__footer--link status-editor__footer--add-poll" title="투표 추가" (click)="addPoll()">
            <fa-icon [icon]="faPollH"></fa-icon>
        </a>

        <a href *ngIf="instanceSupportsScheduling"
            class="status-editor__footer--link" title="예약" (click)="schedule()">
            <fa-icon [icon]="faClock"></fa-icon>
        </a>
    </div>

    <context-menu #contextMenu>
        <ng-template contextMenuItem (execute)="changePrivacy('Public')">
            <fa-icon [icon]="faGlobeAmericas" class="context-menu-icon"></fa-icon> 공개
        </ng-template>
        <ng-template contextMenuItem (execute)="changePrivacy('Unlisted')">
            <fa-icon [icon]="faLockOpen" class="context-menu-icon"></fa-icon> 타임라인에 비표시
        </ng-template>
        <ng-template contextMenuItem (execute)="changePrivacy('Follows-only')">
            <fa-icon [icon]="faLock" class="context-menu-icon"></fa-icon> 팔로워 전용
        </ng-template>
        <ng-template contextMenuItem (execute)="changePrivacy('DM')">
            <fa-icon [icon]="faEnvelope" class="context-menu-icon"></fa-icon> 멘션한 사람들만
        </ng-template>
    </context-menu>
    <app-media></app-media>
</form>
